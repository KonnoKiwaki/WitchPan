import{d as O,o as l,c as r,a as t,r as d,A as R,e as U,g as b,h as c,w as a,x as W,y as G,i as p,t as f,E as k,l as L,j as x,F as P,K as F,k as N,m as J,p as Q,n as X}from"./index-ea894644.js";import{B as Y}from"./Table-3fbda55d.js";import{_ as D}from"./ShareFile.vue_vue_type_style_index_0_scoped_425f0df5_lang-c0a08c93.js";import{h as S,_ as Z}from"./Dialog-65b9ab6b.js";import{I as C}from"./Icon-9aaaa943.js";import{i as ee,s as te}from"./setting-8d83341a.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";const oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},le=t("defs",null,null,-1),ne=t("path",{d:"M508 704c79.5 0 144-64.5 144-144s-64.5-144-144-144s-144 64.5-144 144s64.5 144 144 144zm0-224c44.2 0 80 35.8 80 80s-35.8 80-80 80s-80-35.8-80-80s35.8-80 80-80z",fill:"currentColor"},null,-1),ie=t("path",{d:"M832 256h-28.1l-35.7-120.9c-4-13.7-16.5-23.1-30.7-23.1h-451c-14.3 0-26.8 9.4-30.7 23.1L220.1 256H192c-17.7 0-32 14.3-32 32v28c0 4.4 3.6 8 8 8h45.8l47.7 558.7a32 32 0 0 0 31.9 29.3h429.2a32 32 0 0 0 31.9-29.3L802.2 324H856c4.4 0 8-3.6 8-8v-28c0-17.7-14.3-32-32-32zm-518.6-76h397.2l22.4 76H291l22.4-76zm376.2 664H326.4L282 324h451.9l-44.3 520z",fill:"currentColor"},null,-1),ce=[le,ne,ie],ae=O({name:"RestOutlined",render:function(g,h){return l(),r("svg",oe,ce)}}),re=[{label:"文件名",prop:"filename",scopedSlots:"filename",ellipsis:!0,minWidth:"60%"},{label:"大小",prop:"fileSize",scopedSlots:"fileSize",minWidth:"20%"},{label:"删除时间",prop:"createTime",scopedSlots:"RowAction",minWidth:"20%"}],T="/recycle";function de(o){return S.request({url:`${T}/loadRecycleList/`,method:"GET",params:o})}function ue(o){return S.request({url:`${T}/recoverFile/${o}`,method:"PUT"},{successMessageText:"恢复成功"})}function _e(o){return S.request({url:`${T}/delFile/${o}`,method:"DELETE"},{successMessageText:"删除成功"})}const pe=o=>(Q("data-v-3d724263"),o=o(),X(),o),fe={class:"recycle"},he={class:"recycle-header"},me={class:"actions"},ve={class:"action-more"},ye={class:"nav"},ke=pe(()=>t("span",{class:"txt"},"回收站",-1)),ge={class:"count"},we={class:"recycle-body"},be={class:"file-list"},xe={class:"file-item"},Ce={key:2,class:"file-name"},Se=["onClick"],Te={class:"edit-action is-confirm"},$e=["onClick"],ze={class:"edit-action is-cancel"},Ee=["onClick"],Re={class:"file-size"},Le={key:0},Fe={key:1},Ne={class:"delete-info"},De={class:"info"},Ve={class:"text"},Be={name:"Recycle"},Me=Object.assign(Be,{setup(o){const g=d(),h=d([]),w=d(re),$=d(0),m=d(1),v=d(),V=R(()=>m.value?"彻底删除":"确认还原"),B=R(()=>m.value?"文件删除后将无法恢复，您确认要彻底删除所选文件吗？":"确认还原选中的文件？"),z=[{title:"还原",label:"copyLink",showLabel:!0,icon:"recovery",onClick:e=>{E(e,0)}},{title:"删除",label:"delete",showLabel:!0,icon:"delete",onClick:e=>{E(e,1)}}],u=U({show:!1,showCancel:!0,buttons:[{type:"primary",text:"确认",click:()=>{H()}}]});function E(e,n){m.value=n,ee(e)?v.value=e.map(y=>y.id).join(","):v.value=e.id,u.show=!0}function M(){var e;(e=g.value)==null||e.reload()}const A=e=>{const n={...e};try{return de(n)}catch{return[]}};function I({totalData:e}){$.value=e}function q(e){e.length>0?w.value[0].label=`已选中${e.length}个文件/文件夹`:w.value[0].label="文件名",h.value=e}const H=async()=>{if(m.value)try{await _e(v.value),k.success("文件已彻底删除")}catch{k.error("操作失败")}else try{await ue(v.value),k.success("文件已恢复")}catch{k.error("操作失败")}u.show=!1,M()};return(e,n)=>{const y=b("el-icon"),K=b("el-button"),j=b("el-input");return l(),r("div",fe,[t("div",he,[t("div",me,[c(K,{type:"primary",round:"",style:{padding:"8px 24px"}},{default:a(()=>[c(y,{size:"16"},{default:a(()=>[c(p(ae))]),_:1}),L(" 清空回收站")]),_:1}),W(t("div",ve,[c(p(D),{value:h.value,actions:z},null,8,["value"])],512),[[G,h.value.length>0]])])]),t("div",ye,[ke,t("span",ge,"已加载"+f($.value)+"个",1)]),t("div",we,[t("div",be,[c(p(Y),{ref_key:"recycleTableRef",ref:g,columns:w.value,"row-key":i=>i.id,request:A,loading:!0,onSelectChange:q,onFetchSuccess:I},{filename:a(({index:i,row:s})=>[t("div",xe,[(s.fileType==3||s.fileType==1)&&s.status==2?(l(),x(C,{key:0,cover:s.fileCover,width:32},null,8,["cover"])):(l(),r(P,{key:1},[s.folderType==0?(l(),x(C,{key:0,"file-type":s.fileType},null,8,["file-type"])):(l(),x(C,{key:1,"file-type":0}))],64)),s.showEdit?N("",!0):(l(),r("span",Ce,[t("span",{class:"text",onClick:F(_=>e.openFile(s),["stop"])},f(s.filename),9,Se)])),s.showEdit?(l(),r("div",{key:3,class:"edit-panel",onClick:n[0]||(n[0]=F(()=>{},["stop"]))},[c(j,{modelValue:s.filenameReal,"onUpdate:modelValue":_=>s.filenameReal=_,modelModifiers:{trim:!0},ref:"editNameRef",size:"small",maxLength:190,onKeyup:J(_=>e.saveNameEdit(i),["enter"])},{suffix:a(()=>[L(f(s.fileSuffix),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"]),t("div",Te,[t("span",{class:"iconfont icon-check",onClick:_=>e.saveNameEdit(i)},null,8,$e)]),t("div",ze,[t("span",{class:"iconfont icon-close",onClick:_=>e.cancelNameEdit(i)},null,8,Ee)])])):N("",!0)])]),fileSize:a(({index:i,row:s})=>[t("div",Re,[s.fileSize?(l(),r("span",Le,f(p(te)(s.fileSize)),1)):(l(),r("span",Fe," - "))])]),RowAction:a(({index:i,row:s})=>[c(p(D),{mode:"row",value:s,field:"recoveryTime",actions:z},null,8,["value"])]),_:1},8,["columns","row-key"])])]),c(Z,{show:u.show,title:V.value,buttons:u.buttons,"show-cancel":!0,width:"400px",onClose:n[1]||(n[1]=i=>u.show=!1)},{default:a(()=>[t("div",Ne,[t("div",De,[t("span",Ve,f(B.value),1)])])]),_:1},8,["show","title","buttons"])])}}}),Ue=se(Me,[["__scopeId","data-v-3d724263"]]);export{Ue as default};
