import{d as O,o,c as d,a as s,T,_ as U,e as r,G as R,f as W,E as k,h as b,i as c,w as a,j as p,m as L,B as G,C as P,t as f,k as C,N as x,F as Z,a1 as N,l as F,p as J,I as Q,q as X,Z as Y,y as ee,z as se}from"./index-cd067b4e.js";import{B as te}from"./Table-58a1515f.js";import{_ as B}from"./ShareFile.vue_vue_type_style_index_0_scoped_ae51d12c_lang-93d12c37.js";const le={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},oe=s("defs",null,null,-1),ne=s("path",{d:"M508 704c79.5 0 144-64.5 144-144s-64.5-144-144-144s-144 64.5-144 144s64.5 144 144 144zm0-224c44.2 0 80 35.8 80 80s-35.8 80-80 80s-80-35.8-80-80s35.8-80 80-80z",fill:"currentColor"},null,-1),ie=s("path",{d:"M832 256h-28.1l-35.7-120.9c-4-13.7-16.5-23.1-30.7-23.1h-451c-14.3 0-26.8 9.4-30.7 23.1L220.1 256H192c-17.7 0-32 14.3-32 32v28c0 4.4 3.6 8 8 8h45.8l47.7 558.7a32 32 0 0 0 31.9 29.3h429.2a32 32 0 0 0 31.9-29.3L802.2 324H856c4.4 0 8-3.6 8-8v-28c0-17.7-14.3-32-32-32zm-518.6-76h397.2l22.4 76H291l22.4-76zm376.2 664H326.4L282 324h451.9l-44.3 520z",fill:"currentColor"},null,-1),ce=[oe,ne,ie],ae=O({name:"RestOutlined",render:function(g,h){return o(),d("svg",le,ce)}}),de=[{label:"文件名",prop:"filename",scopedSlots:"filename",ellipsis:!0,minWidth:"60%"},{label:"大小",prop:"fileSize",scopedSlots:"fileSize",minWidth:"20%"},{label:"删除时间",prop:"createTime",scopedSlots:"RowAction",minWidth:"20%"}],S="/recycle";function re(l){return T.request({url:`${S}/loadRecycleList/`,method:"GET",params:l})}function ue(l){return T.request({url:`${S}/recoverFile/${l}`,method:"PUT"},{successMessageText:"恢复成功"})}function _e(l){return T.request({url:`${S}/delFile/${l}`,method:"DELETE"},{successMessageText:"删除成功"})}const pe=l=>(ee("data-v-3d724263"),l=l(),se(),l),fe={class:"recycle"},he={class:"recycle-header"},me={class:"actions"},ve={class:"action-more"},ye={class:"nav"},ke=pe(()=>s("span",{class:"txt"},"回收站",-1)),ge={class:"count"},we={class:"recycle-body"},be={class:"file-list"},Ce={class:"file-item"},xe={key:2,class:"file-name"},Te=["onClick"],Se={class:"edit-action is-confirm"},$e=["onClick"],ze={class:"edit-action is-cancel"},Ee=["onClick"],Re={class:"file-size"},Le={key:0},Ne={key:1},Fe={class:"delete-info"},Be={class:"info"},De={class:"text"},Ve={name:"Recycle"},Me=Object.assign(Ve,{setup(l){const g=r(),h=r([]),w=r(de),$=r(0),m=r(1),v=r(),D=R(()=>m.value?"彻底删除":"确认还原"),V=R(()=>m.value?"文件删除后将无法恢复，您确认要彻底删除所选文件吗？":"确认还原选中的文件？"),z=[{title:"还原",label:"copyLink",showLabel:!0,icon:"recovery",onClick:e=>{E(e,0)}},{title:"删除",label:"delete",showLabel:!0,icon:"delete",onClick:e=>{E(e,1)}}],u=W({show:!1,showCancel:!0,buttons:[{type:"primary",text:"确认",click:()=>{H()}}]});function E(e,n){m.value=n,Y(e)?v.value=e.map(y=>y.id).join(","):v.value=e.id,u.show=!0}function M(){var e;(e=g.value)==null||e.reload()}const I=e=>{const n={...e};try{return re(n)}catch{return[]}};function q({totalData:e}){$.value=e}function A(e){e.length>0?w.value[0].label=`已选中${e.length}个文件/文件夹`:w.value[0].label="文件名",h.value=e}const H=async()=>{if(m.value)try{await _e(v.value),k.success("文件已彻底删除")}catch{k.error("操作失败")}else try{await ue(v.value),k.success("文件已恢复")}catch{k.error("操作失败")}u.show=!1,M()};return(e,n)=>{const y=b("el-icon"),j=b("el-button"),K=b("el-input");return o(),d("div",fe,[s("div",he,[s("div",me,[c(j,{type:"primary",round:"",style:{padding:"8px 24px"}},{default:a(()=>[c(y,{size:"16"},{default:a(()=>[c(p(ae))]),_:1}),L(" 清空回收站")]),_:1}),G(s("div",ve,[c(p(B),{value:h.value,actions:z},null,8,["value"])],512),[[P,h.value.length>0]])])]),s("div",ye,[ke,s("span",ge,"已加载"+f($.value)+"个",1)]),s("div",we,[s("div",be,[c(p(te),{ref_key:"recycleTableRef",ref:g,columns:w.value,"row-key":i=>i.id,request:I,loading:!0,onSelectChange:A,onFetchSuccess:q},{filename:a(({index:i,row:t})=>[s("div",Ce,[(t.fileType==3||t.fileType==1)&&t.status==2?(o(),C(x,{key:0,cover:t.fileCover,width:32},null,8,["cover"])):(o(),d(Z,{key:1},[t.folderType==0?(o(),C(x,{key:0,"file-type":t.fileType},null,8,["file-type"])):(o(),C(x,{key:1,"file-type":0}))],64)),t.showEdit?F("",!0):(o(),d("span",xe,[s("span",{class:"text",onClick:N(_=>e.openFile(t),["stop"])},f(t.filename),9,Te)])),t.showEdit?(o(),d("div",{key:3,class:"edit-panel",onClick:n[0]||(n[0]=N(()=>{},["stop"]))},[c(K,{modelValue:t.filenameReal,"onUpdate:modelValue":_=>t.filenameReal=_,modelModifiers:{trim:!0},ref:"editNameRef",size:"small",maxLength:190,onKeyup:J(_=>e.saveNameEdit(i),["enter"])},{suffix:a(()=>[L(f(t.fileSuffix),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"]),s("div",Se,[s("span",{class:"iconfont icon-check",onClick:_=>e.saveNameEdit(i)},null,8,$e)]),s("div",ze,[s("span",{class:"iconfont icon-close",onClick:_=>e.cancelNameEdit(i)},null,8,Ee)])])):F("",!0)])]),fileSize:a(({index:i,row:t})=>[s("div",Re,[t.fileSize?(o(),d("span",Le,f(p(Q)(t.fileSize)),1)):(o(),d("span",Ne," - "))])]),RowAction:a(({index:i,row:t})=>[c(p(B),{mode:"row",value:t,field:"recoveryTime",actions:z},null,8,["value"])]),_:1},8,["columns","row-key"])])]),c(X,{show:u.show,title:D.value,buttons:u.buttons,"show-cancel":!0,width:"400px",onClose:n[1]||(n[1]=i=>u.show=!1)},{default:a(()=>[s("div",Fe,[s("div",Be,[s("span",De,f(V.value),1)])])]),_:1},8,["show","title","buttons"])])}}}),He=U(Me,[["__scopeId","data-v-3d724263"]]);export{He as default};
