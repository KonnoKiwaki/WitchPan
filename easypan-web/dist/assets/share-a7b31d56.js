import{I as c}from"./Icon-9aaaa943.js";import{B as M}from"./Table-3fbda55d.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";import{A as U,o as t,c as o,h as n,k as S,a as s,j as r,F as f,t as _,v as z,p as L,n as A,r as p,e as G,g as H,i as b,w as v,E as I}from"./index-ea894644.js";import{_ as B}from"./ShareFile.vue_vue_type_style_index_0_scoped_425f0df5_lang-c0a08c93.js";import{_ as J}from"./Dialog-65b9ab6b.js";import{i as k}from"./setting-8d83341a.js";import{u as K}from"./index-75dd74c6.js";import{l as P}from"./share-3d2961f5.js";const Q=[{label:"分享文件",prop:"filename",scopedSlots:"filename",ellipsis:!0,minWidth:"48%"},{label:"分享时间",prop:"createTime",minWidth:"25%"},{label:"状态",prop:"expireTime",scopedSlots:"RowAction",minWidth:"25%"},{label:"浏览次数",prop:"browseCount",scopedSlots:"BrowseCount",minWidth:"12%"}];const x=a=>(L("data-v-615468d2"),a=a(),A(),a),X={class:"detail-main"},Y=x(()=>s("div",{class:"detail-title"},[s("span",null,"分享详情")],-1)),Z={key:0,class:"muti-file"},ee={key:1,class:"detail-content"},se={class:"filename"},te={class:"text"},le={key:0,class:"content-item"},oe={class:"label"},ae={class:"value"},ie={key:1,class:"divider"},ne={key:2,class:"detail-empty"},ce=x(()=>s("img",{src:"https://nd-static.bdstatic.com/m-static/v20-main/home/img/empty-folder.55c81ea2.png",alt:""},null,-1)),de=x(()=>s("p",null,"选中文件，查看详情",-1)),re=[ce,de],_e={name:"ShareDetail"},ue=Object.assign(_e,{props:{value:{type:Array,default:[]}},setup(a){const g=a,m=[{label:"分享时间",key:"createTime"},{label:"有效期",key:"expireTime"},{label:"提取码",key:"code"},{label:"divider",key:"divider"},{label:"浏览",key:"browseCount"},{label:"保存",key:"saveCount"},{label:"下载",key:" downloadCount"}],l=U(()=>g.value.length===1?g.value[0]:null);return($,C)=>(t(),o("div",X,[Y,!l.value&&a.value.length>1?(t(),o("div",Z,[n(c,{"icon-name":"folder_big",width:128})])):S("",!0),l.value?(t(),o("div",ee,[s("div",se,[(l.value.fileType==3||l.value.fileType==1)&&l.value.status==2?(t(),r(c,{key:0,cover:l.value.fileCover},null,8,["cover"])):(t(),o(f,{key:1},[l.value.folderType==0?(t(),r(c,{key:0,"file-type":l.value.fileType},null,8,["file-type"])):(t(),r(c,{key:1,"icon-name":"folder_2"}))],64)),s("span",te,_(l.value.filename),1)]),(t(),o(f,null,z(m,u=>(t(),o(f,null,[u.label!=="divider"?(t(),o("div",le,[s("div",oe,_(u.label),1),s("div",ae,_(l.value[u.key]||0),1)])):(t(),o("div",ie))],64))),64))])):S("",!0),a.value.length===0?(t(),o("div",ne,re)):S("",!0)]))}}),he=F(ue,[["__scopeId","data-v-615468d2"]]);const w=a=>(L("data-v-17bfacc5"),a=a(),A(),a),pe={class:"share-container"},ve={class:"share-header"},fe={key:0,class:"top"},me=w(()=>s("span",{class:"title"},"链接分享",-1)),ye=w(()=>s("span",{class:"content"},"(分享失败超过1年以上的链接记录将被自动清理)",-1)),be=[me,ye],ke={key:1,class:"actions"},we={class:"share-body"},ge={class:"left-container"},$e={class:"nav"},Ce=w(()=>s("span",{class:"txt"},"全部文件",-1)),Se={class:"count"},xe={class:"file-list"},Te={class:"file-item"},Ie={class:"filename"},Be={class:"text",style:{"padding-left":"5px"}},Fe={class:"hover-hidden"},Le={class:"right-detail"},Ae=w(()=>s("div",{class:"delete-info"},[s("div",{class:"info"},[s("span",{class:"text"},"取消分享后，该条分享记录将被删除，好友将无法再访问此分享链接。 您确认要取消分享吗？")])],-1)),De={name:"Share"},Re=Object.assign(De,{emits:["addFile"],setup(a,{emit:g}){const m=p(),l=p([]),$=p([]),C=p(0),{toClipboard:u}=K(),D=p(document.location.origin+"/share/"),T=[{title:"复制链接",label:"copyLink",showLabel:!0,icon:"link",isShow:e=>!k(e)||k(e)&&e.length==1,onClick:e=>{O(e)}},{title:"取消分享",label:"cancelShare",showLabel:!0,icon:"stop",onClick:e=>{E(e)}}],d=G({show:!1,title:"确认取消分享",showCancel:!0,buttons:[{type:"primary",text:"确认",click:()=>{V()}}]}),R=e=>P(e);function j({resultTotal:e}){C.value=e}function N(){var e;(e=m.value)==null||e.reload()}function W(e){l.value=e}const E=e=>{k(e)?$.value=e.map(y=>y.id).join(","):$.value=e.id,d.show=!0},V=()=>{I.success("取消外链分享成功"),N(),d.show=!1},O=async e=>{k(e)&&(e=e[0]),await u(`链接: ${D.value}${e.shareId} 提取码: ${e.code}`),I.success("复制成功")};return(e,y)=>{const q=H("el-scrollbar");return t(),o(f,null,[s("div",pe,[s("div",ve,[l.value.length==0?(t(),o("div",fe,be)):(t(),o("div",ke,[n(b(B),{value:l.value,mode:"btns",actions:T},null,8,["value"])]))]),s("div",we,[s("div",ge,[s("div",$e,[Ce,s("span",Se,"已加载"+_(C.value)+"个",1)]),s("div",xe,[n(b(M),{ref_key:"shareTableRef",ref:m,columns:b(Q),"row-key":h=>h.id,request:R,onSelectChange:W,onFetchSuccess:j},{filename:v(({index:h,row:i})=>[s("div",Te,[(i.fileType==3||i.fileType==1)&&i.status==2?(t(),r(c,{key:0,cover:i.fileCover,width:32},null,8,["cover"])):(t(),o(f,{key:1},[i.folderType==0?(t(),r(c,{key:0,"file-type":i.fileType},null,8,["file-type"])):(t(),r(c,{key:1,"icon-name":"folder_2",width:40}))],64)),s("span",Ie,[s("span",Be,_(i.filename),1)])])]),RowAction:v(({index:h,row:i})=>[n(b(B),{value:i,mode:"row",actions:T},null,8,["value"])]),BrowseCount:v(({index:h,row:i})=>[s("span",Fe,_(i.browseCount),1)]),_:1},8,["columns","row-key"])])]),s("div",Le,[n(q,{"wrap-style":"position: absolute;left:0;right:0;"},{default:v(()=>[n(he,{value:l.value},null,8,["value"])]),_:1})])])]),n(J,{show:d.show,title:d.title,buttons:d.buttons,"show-cancel":!0,width:"400px",onClose:y[0]||(y[0]=h=>d.show=!1)},{default:v(()=>[Ae]),_:1},8,["show","title","buttons"])],64)}}}),ze=F(Re,[["__scopeId","data-v-17bfacc5"]]);export{ze as default};
